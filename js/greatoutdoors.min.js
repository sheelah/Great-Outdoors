/*! GreatOutdoors - v0.1.0 - 2014-12-05
* Copyright (c) 2014 ; Licensed  */
/*!
 * jQuery Sticky Footer 2.0
 * Corey Snyder
 * http://tangerineindustries.com
 * Modified in-project to account for possibility of multiple footer tags in a page (WordPress)
 *
 * Released under the MIT license
 *
 * Copyright 2013 Corey Snyder.
 *
 * Date: Thu Jan 22 2013 13:34:00 GMT-0630 (Eastern Daylight Time)
 * Modification for jquery 1.9+ Tue May 7 2013
 * Modification for non-jquery, removed all, now classic JS Wed Jun 12 2013
 * Modification for Foundation 5 auto height issues
 * Modification for new DOM change event listener
 */

window.onload = function() {
    stickyFooter();
    observer.observe(target, config);
};

//check for changes to the DOM
var target = document.body;

// create an observer instance
var observer = new MutationObserver(mutationObjectCallback);
function mutationObjectCallback(mutationRecordsList) {

    stickyFooter();
};

// configuration of the observer:
var config = { attributes: true, childList: true, characterData: true };


//check for resize event
window.onresize = function() {
    stickyFooter();
}

//lets get the marginTop for the <footer>
function getCSS(element, property) {

    var elem = document.getElementById(element);
    var css = null;

    if (elem.currentStyle) {
        css = elem.currentStyle[property];

    } else if (window.getComputedStyle) {
        css = document.defaultView.getComputedStyle(elem, null).
            getPropertyValue(property);
    }

    return css;

}

function stickyFooter() {
    observer.disconnect();
    document.body.setAttribute("style","height:auto");

    if (document.getElementById("colophon").getAttribute("style") != null) {
        document.getElementById("colophon").removeAttribute("style");
    }

    if (window.innerHeight != document.body.offsetHeight) {
        var offset = window.innerHeight - document.body.offsetHeight;
        var current = getCSS("colophon", "margin-top");

        if (isNaN(current) == true) {
            document.getElementById("colophon").setAttribute("style","margin-top:0px;");
            current = 0;
        } else {
            current = parseInt(current);
        }

        if (current+offset > parseInt(getCSS("colophon", "margin-top"))) {
            document.getElementById("colophon").setAttribute("style","margin-top:"+(current+offset)+"px;");
        }
    }

    document.body.setAttribute("style","height:100%");

    //reconnect
    observer.observe(target, config);
}

/*
 ! end sticky footer
 */

// Foundation JavaScript
// Documentation can be found at: http://foundation.zurb.com/docs
// Works with both jQuery 1.10.2 and 2.0...
jQuery.noConflict();
jQuery(document).foundation();

jQuery(document).ready(function($) {
	var searchToggle = $(".search-toggle");
	searchToggle.on('click', function() {
		$("#search-container").slideToggle('medium', function() {
			searchToggle.toggleClass('active');
		});
	});
});


( function() {
	var is_webkit = navigator.userAgent.toLowerCase().indexOf( 'webkit' ) > -1,
	    is_opera  = navigator.userAgent.toLowerCase().indexOf( 'opera' )  > -1,
	    is_ie     = navigator.userAgent.toLowerCase().indexOf( 'msie' )   > -1;

	if ( ( is_webkit || is_opera || is_ie ) && document.getElementById && window.addEventListener ) {
		window.addEventListener( 'hashchange', function() {
			var element = document.getElementById( location.hash.substring( 1 ) );

			if ( element ) {
				if ( ! /^(?:a|select|input|button|textarea)$/i.test( element.tagName ) )
					element.tabIndex = -1;

				element.focus();
			}
		}, false );
	}
})();
